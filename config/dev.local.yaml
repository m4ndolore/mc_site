# Development Configuration - Local Mode (Localhost)
# ==================================================
# For local development without Cloudflare tunnel
# Start with: docker compose --profile local up

# Core Runtime
APP_ENV: dev
NODE_ENV: development

# URLs - All localhost
PUBLIC_BASE_URL: http://localhost:2368
GHOST_INTERNAL_URL: http://ghost-local:2368
THEME_API_BASE_URL: http://localhost:2000
THEME_SAM_VALIDATOR_URL: https://sam-validator.defensebuilders.workers.dev
SAM_VALIDATOR_URL: https://sam-validator.defensebuilders.workers.dev

# OIDC - Local development
OIDC_CLIENT_ID: VsCbcc6DuDjFV5aKzXPpSc4UKACuonWOvk6O9iyc
OIDC_REDIRECT_URI: http://localhost:2000/auth/callback

# OAuth Client
OAUTH_CLIENT_ID: VsCbcc6DuDjFV5aKzXPpSc4UKACuonWOvk6O9iyc
OAUTH_REDIRECT_URI: http://localhost:2000/auth/callback

# OAuth Endpoints (Local Authentik)
OAUTH_AUTHORIZE_URL: http://localhost:9000/application/o/authorize/
OAUTH_TOKEN_URL: http://host.docker.internal:9000/application/o/token/
OAUTH_USERINFO_URL: http://host.docker.internal:9000/application/o/userinfo/
OAUTH_JWKS_URL: http://host.docker.internal:9000/application/o/ghost-cms/jwks/
OAUTH_LOGOUT_URL: http://localhost:9000/application/o/ghost-cms/end-session/

# Authentik
AUTHENTIK_BASE_URL: http://localhost:9000
AUTHENTIK_ADMIN_GROUP_SLUGS: authentik Admins
AUTHENTIK_LOGIN_FLOW_SLUG: sigmablox-auth-flow
AUTHENTIK_OIDC_ISSUER: https://auth.sigmablox.com/application/o/sigmablox-ghost-dev/
AUTHENTIK_REDIRECT_URI: http://localhost:2000/ghost/sso/callback

# Ghost
GHOST_DB_CLIENT: sqlite3  # Local dev uses SQLite
GHOST_AUTHOR_DEFAULT_ROLE: Contributor

# MongoDB
MONGODB_DB_NAME: sigmablox_users_dev

# SMTP - Local (Mailpit)
SMTP_HOST: mailpit
SMTP_PORT: 1025
SMTP_USER: test@sigmablox.local
SMTP_SECURE: false

# Ghost mail (Ghost expects mail__* keys)
mail__transport: SMTP
mail__options__host: mailpit
mail__options__port: 1025
mail__options__secure: "false"
mail__from: "SigmaBlox Local <noreply@localhost>"

# Ensure Ghost does NOT try SMTP AUTH locally
mail__options__auth__user: ""
mail__options__auth__pass: ""

# Email Configuration (for relay without authentication)
AUTHENTIK_EMAIL__FROM: noreply@mergecombinator.com
AUTHENTIK_EMAIL__HOST: smtp-relay.gmail.com
AUTHENTIK_EMAIL__PORT: 587
AUTHENTIK_EMAIL__USE_TLS: true
AUTHENTIK_EMAIL__USE_SSL: false
AUTHENTIK_EMAIL__TIMEOUT: 10
AUTHENTIK_EMAIL_FROM_NAME: SigmaBlox Auth

# CORS - Local origins
ALLOWED_ORIGINS: http://localhost:2000,http://localhost:2368,http://localhost:9000

# Security - Relaxed for local
SESSION_COOKIE_SECURE: false
SESSION_COOKIE_DOMAIN: localhost
TRUST_PROXY: false

# Authentik Container Ports
COMPOSE_PORT_HTTP: 9000
COMPOSE_PORT_HTTPS: 9443

# Authentik PostgreSQL
PG_DB: authentik
PG_USER: authentik

# Authentik Image
AUTHENTIK_IMAGE: ghcr.io/goauthentik/server
AUTHENTIK_TAG: 2025.4.4

# Authentik Runtime Flags
AUTHENTIK_ERROR_REPORTING: false
AUTHENTIK_LOG_LEVEL: info
AUTHENTIK_DISABLE_EMBEDDED_OUTPOST: false
AUTHENTIK_STORAGE__MEDIA__BACKEND: file
AUTHENTIK_STORAGE__MEDIA__PATH: /opt/authentik/media
